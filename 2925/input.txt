Sample 1
abc
4
1 2 c
4 3 a
2 4 b

Sample 2
abc
1

Sample 3
zy
6
1 2 x
1 3 y
1 4 z
3 5 a
4 6 b